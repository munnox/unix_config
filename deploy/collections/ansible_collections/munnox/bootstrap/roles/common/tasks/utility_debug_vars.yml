---
# Debug information for machines and groups
# https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html

# Module Index https://docs.ansible.com/ansible/latest/modules/modules_by_category.html
- name: Run the uptime command
  shell: /usr/bin/uptime
  register: result
# https://docs.ansible.com/ansible/latest/modules/debug_module.html#debug-module
- name: Display result from previous command
  ansible.builtin.debug:
    var: result
- name: "Display Facts"
  ansible.builtin.debug:
    msg: |
      Facts for nodename: "{{ ansible_nodename }}" fqdn: "{{ ansible_fqdn }}" distribution:
      * Distibution 'ansible_distribution' {{ ansible_distribution }}
      * Version 'ansible_distribution_release' {{ ansible_distribution_release }}

      groups: {{ groups }}

      inventory file: {{ inventory_file }}

      Inventory varible test: {{ inventory_test }}

      Host Variable keys:
      {{ hostvars[inventory_hostname].keys() | to_nice_json }}

      Machine Fact keys:
      {{ ansible_facts.keys()  | to_nice_json }}
  # {{ hostvars[inventory_hostname]vim /etc/.split('\n') | to_nice_json}}
  when: item != 'localhost' and item != '127.0.0.1'
  with_items:
    - "{{ groups.all | list }}"

# Sourced from https://gryzli.info/2017/12/21/ansible-debug-print-variables/
# To run just the debug task tag with debug_info run:
# ansible-playbook --tags "debug_info" debug_os.yml
# following works for yaml plugin swap vars with debug
- name: Print some debug information
  ansible.builtin.vars:
    msg: |
      Module Variables ("vars"):
      --------------------------------
      {{ vars | to_nice_json }} 

      Environment Variables ("environment"):
      --------------------------------
      {{ environment | to_nice_json }} 

      GROUP NAMES Variables ("group_names"):
      --------------------------------
      {{ group_names | to_nice_json }}

      GROUPS Variables ("groups"):
      --------------------------------
      {{ groups | to_nice_json }}

      HOST Variables keys ("hostvars"):
      --------------------------------
      {{ hostvars.keys() | to_nice_json }}
      {# {{ hostvars | to_nice_json }} #}
  debug:
    # following works for the standard stdout
    # msg: "{{ msg.split('\n') }}"
    # following works for yaml plugin can also swap vars with debug see the ansible.cfg
    msg: "{{ msg }}"
  tags: debug_info
