# Remove the swap file from a target using sed
# 
# Example Playbook
# 
# ```
# - name: Turn off swap on Hosts
#   hosts: "{{ playbook_groups | default('noswap') }},!disabled"
#   tasks:
#     - name: Turn off swap on a host
#       import_role:
#         name: munnox.bootstrap.common
#         tasks_from: utility_noswap.yml
# ```

- name: Remove swap on RHEL
  become: yes
  shell: |
    sed -i 's/^[#]*\(.*swap.*\)/#\1/' /etc/fstab
    swapoff -a
  when: ansible_os_family == 'RedHat'
- name: Remove swap on Debian
  become: yes
  shell: |
    sed -i 's/^[#]*\(.*swap.*\)/#\1/' /etc/fstab
    swapoff -a
  when: ansible_os_family == 'Debian'