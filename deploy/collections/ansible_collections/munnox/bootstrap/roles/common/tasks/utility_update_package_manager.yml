# Update the package manager for the os

# Update packages by running a task file from the common role.
# 
# Example Playbook
# 
# ```
# - name: Update packages on host
#   hosts: "{{ playbook_groups | default('localhost') }},!disabled"
#   tasks:
#     - name: update package manager
#       ansible.builtin.import_role:
#         name: munnox.bootstrap.common
#         tasks_from: utility_update_package_manager.yml
# ```

# Update packages on Debian
- name: Update the packagemanager on Debian/Ubuntu
  become: true
  ansible.builtin.apt:
    update_cache: true
    upgrade: full
    # name: "*"
    # update_cache: true
    # state: latest
    # update_only: true
    # name: git
    # state: latest
  when: ansible_pkg_mgr == 'apt'
# Update packages on RHEL DNF
- name: Upgrade all packages on RHEL/CentOS/Fedora using DNF
  become: true
  when: ansible_pkg_mgr == 'dnf'
  ansible.builtin.dnf:
    name: "*"
    state: latest
    update_only: true

# Update packages on RHEL YUM
- name: Update the package manager on RHEL/CentOS/fedora using YUM
  become: true
  ansible.builtin.yum:
    name: '*'
    state: latest
    update_only: true
  when: ansible_pkg_mgr == 'yum'
